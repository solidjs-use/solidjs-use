import{O as x,z as l,b as S,P as z,L as B,a0 as H}from"./index-dd3ae440.js";import{c as L}from"./index-9194fd7c.js";const M=e=>e,D=(e,r)=>e(r);function I(e){return e?H(e)?e:L:M}function J(e){return e?H(e)?e:L:M}function j(e,r={}){const[i,O]=x(e),{clone:m=!1,dump:P=I(m),parse:U=J(m),setSource:V=D}=r;function p(){return{snapshot:P(i()),timestamp:B()}}const[s,d]=l(p()),[a,o]=l([]),[c,u]=l([]),f=t=>{V(O,U(t.snapshot)),d(t)},h=()=>{o(t=>[s(),...t]),d(p()),r.capacity&&a().length>r.capacity&&o(([...t])=>(t.splice(r.capacity,1/0),t)),c().length&&u(([...t])=>(t.splice(0,c().length),t))},g=()=>{o([]),u([])},_=()=>{const t=a()[0];o(([...n])=>(n.shift(),n)),t&&(u(n=>[s(),...n]),f(t))},b=()=>{const t=c()[0];u(([...n])=>(n.shift(),n)),t&&(o(n=>[s(),...n]),f(t))},v=()=>{f(s())},y=S(()=>[s(),...a()]),R=S(()=>a().length>0),F=S(()=>c().length>0);return z(e)?{source:i,undoStack:a,redoStack:c,last:s,history:y,canUndo:R,canRedo:F,clear:g,commit:h,reset:v,undo:_,redo:b}:{source:i,undoStack:a,redoStack:c,last:s,history:y,canUndo:R,canRedo:F,clear:g,commit:h}}export{j as u};
