import{z as c,b as n,W as w}from"./index-4fc0f19c.js";import{u as y}from"./index-8b8e7e02.js";import{u as S}from"./index-8932e1ea.js";import{u as h}from"./index-3ba827e3.js";function M(d={}){const{navigator:t=w,requestPermissions:m=!1,constraints:f={audio:!0,video:!0},onUpdated:p}=d,[s,v]=c([]),[r,o]=c(!1),l=n(()=>s().filter(e=>e.kind==="videoinput")),D=n(()=>s().filter(e=>e.kind==="audioinput")),g=n(()=>s().filter(e=>e.kind==="audiooutput")),i=h(()=>t?.mediaDevices?.enumerateDevices);async function a(){if(!i())return;const e=await t.mediaDevices.enumerateDevices();v(e),p?.(e)}async function u(){if(!i())return!1;if(r())return!0;const{state:e,query:k}=S("camera",{controls:!0});return await k(),e()!=="granted"&&((await t.mediaDevices.getUserMedia(f)).getTracks().forEach(P=>P.stop()),a()),o(!0),r()}return i()&&(m&&u(),y(t.mediaDevices,"devicechange",a),a()),{devices:s,ensurePermissions:u,permissionGranted:r,videoInputs:l,audioInputs:D,audioOutputs:g,isSupported:i}}export{M as u};
