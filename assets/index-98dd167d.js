import{r as f,b as u,X as w}from"./index-3c801358.js";import{u as y}from"./index-c8b813f7.js";import{u as S}from"./index-78f05f3c.js";import{u as h}from"./index-bfe01d69.js";function L(m={}){const{navigator:t=w,requestPermissions:p=!1,constraints:v={audio:!0,video:!0},onUpdated:l}=m,[i,D]=f([]),[a,c]=f(!1),g=u(()=>i().filter(e=>e.kind==="videoinput")),k=u(()=>i().filter(e=>e.kind==="audioinput")),P=u(()=>i().filter(e=>e.kind==="audiooutput")),s=h(()=>t?.mediaDevices?.enumerateDevices);let r;async function n(){if(!s())return;const e=await t.mediaDevices.enumerateDevices();D(e),l?.(e),r&&(r.getTracks().forEach(o=>o.stop()),r=null)}async function d(){if(!s())return!1;if(a())return!0;const{state:e,query:o}=S("camera",{controls:!0});return await o(),e()!=="granted"&&(r=await t.mediaDevices.getUserMedia(v),n()),c(!0),a()}return s()&&(p&&d(),y(t.mediaDevices,"devicechange",n),n()),{devices:i,ensurePermissions:d,permissionGranted:a,videoInputs:g,audioInputs:k,audioOutputs:P,isSupported:s}}export{L as u};
